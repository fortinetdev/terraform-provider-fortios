---
subcategory: "FortiGate IPS"
layout: "fortios"
page_title: "FortiOS: fortios_ips_sensor"
description: |-
  Configure IPS sensor.
---

# fortios_ips_sensor
Configure IPS sensor.

## Argument Reference

The following arguments are supported:

* `name` - (Required) Sensor name.
* `comment` - Comment.
* `replacemsg_group` - Replacement message group.
* `block_malicious_url` - Enable/disable malicious URL blocking. Valid values: `disable`, `enable`.
* `scan_botnet_connections` - Block or monitor connections to Botnet servers, or disable Botnet scanning. Valid values: `disable`, `block`, `monitor`.
* `extended_log` - Enable/disable extended logging. Valid values: `enable`, `disable`.
* `entries` - IPS sensor filter. The structure of `entries` block is documented below.
* `filter` - IPS sensor filter. The structure of `filter` block is documented below.
* `override` - IPS override rule. The structure of `override` block is documented below.
* `dynamic_sort_subtable` - Sort sub-tables, please do not set this parameter when configuring static sub-tables. Options: [ false, true, natural, alphabetical ]. false: Default value, do not sort tables; true/natural: sort tables in natural order. For example: [ a10, a2 ] --> [ a2, a10 ]; alphabetical: sort tables in alphabetical order. For example: [ a10, a2 ] --> [ a10, a2 ].
* `get_all_tables` - Get all sub-tables including unconfigured tables. Do not set this variable to true if you configure sub-table in another resource, otherwise, conflicts and overwrite will occur. Options: [ false, true ]. false: Default value, do not get unconfigured tables; true: get all tables including unconfigured tables. 
* `vdomparam` - Specifies the vdom to which the resource will be applied when the FortiGate unit is running in VDOM mode. Only one vdom can be specified. If you want to inherit the vdom configuration of the provider, please do not set this parameter.

The `entries` block supports:

* `id` - Rule ID in IPS database (0 - 4294967295).
* `rule` - Identifies the predefined or custom IPS signatures to add to the sensor. The structure of `rule` block is documented below.
* `location` - Protect client or server traffic.
* `severity` - Relative severity of the signature, from info to critical. Log messages generated by the signature include the severity.
* `protocol` - Protocols to be examined. set protocol ? lists available protocols. all includes all protocols. other includes all unlisted protocols.
* `os` - Operating systems to be protected.  all includes all operating systems. other includes all unlisted operating systems.
* `application` - Applications to be protected. set application ? lists available applications. all includes all applications. other includes all unlisted applications.
* `default_action` - Signature default action filter. Valid values: `all`, `pass`, `block`.
* `default_status` - Signature default status filter. Valid values: `all`, `enable`, `disable`.
* `cve` - List of CVE IDs of the signatures to add to the sensor The structure of `cve` block is documented below.
* `vuln_type` - List of signature vulnerability types to filter by. The structure of `vuln_type` block is documented below.
* `last_modified` - Filter by signature last modified date. Formats: before <date>, after <date>, between <start-date> <end-date>.
* `status` - Status of the signatures included in filter. default enables the filter and only use filters with default status of enable. Filters with default status of disable will not be used. Valid values: `disable`, `enable`, `default`.
* `log` - Enable/disable logging of signatures included in filter. Valid values: `disable`, `enable`.
* `log_packet` - Enable/disable packet logging. Enable to save the packet that triggers the filter. You can download the packets in pcap format for diagnostic use. Valid values: `disable`, `enable`.
* `log_attack_context` - Enable/disable logging of attack context: URL buffer, header buffer, body buffer, packet buffer. Valid values: `disable`, `enable`.
* `action` - Action taken with traffic in which signatures are detected. Valid values: `pass`, `block`, `reset`, `default`.
* `rate_count` - Count of the rate.
* `rate_duration` - Duration (sec) of the rate.
* `rate_mode` - Rate limit mode. Valid values: `periodical`, `continuous`.
* `rate_track` - Track the packet protocol field. Valid values: `none`, `src-ip`, `dest-ip`, `dhcp-client-mac`, `dns-domain`.
* `exempt_ip` - Traffic from selected source or destination IP addresses is exempt from this signature. The structure of `exempt_ip` block is documented below.
* `quarantine` - Quarantine method. Valid values: `none`, `attacker`.
* `quarantine_expiry` - Duration of quarantine. (Format ###d##h##m, minimum 1m, maximum 364d23h59m, default = 5m). Requires quarantine set to attacker.
* `quarantine_log` - Enable/disable quarantine logging. Valid values: `disable`, `enable`.

The `rule` block supports:

* `id` - Rule IPS.

The `cve` block supports:

* `cve_entry` - CVE IDs or CVE wildcards.

The `vuln_type` block supports:

* `id` - Vulnerability type ID.

The `exempt_ip` block supports:

* `id` - Exempt IP ID.
* `src_ip` - Source IP address and netmask (applies to packet matching the signature).
* `dst_ip` - Destination IP address and netmask (applies to packet matching the signature).

The `filter` block supports:

* `name` - Filter name.
* `location` - Vulnerability location filter.
* `severity` - Vulnerability severity filter.
* `protocol` - Vulnerable protocol filter.
* `os` - Vulnerable OS filter.
* `application` - Vulnerable application filter.
* `status` - Selected rules status. Valid values: `disable`, `enable`, `default`.
* `log` - Enable/disable logging of selected rules. Valid values: `disable`, `enable`.
* `log_packet` - Enable/disable packet logging of selected rules. Valid values: `disable`, `enable`.
* `action` - Action of selected rules. Valid values: `pass`, `block`, `reset`, `default`.
* `quarantine` - Quarantine IP or interface. Valid values: `none`, `attacker`.
* `quarantine_expiry` - Duration of quarantine in minute.
* `quarantine_log` - Enable/disable logging of selected quarantine. Valid values: `disable`, `enable`.

The `override` block supports:

* `rule_id` - Override rule ID.
* `status` - Enable/disable status of override rule. Valid values: `disable`, `enable`.
* `log` - Enable/disable logging. Valid values: `disable`, `enable`.
* `log_packet` - Enable/disable packet logging. Valid values: `disable`, `enable`.
* `action` - Action of override rule. Valid values: `pass`, `block`, `reset`.
* `quarantine` - Quarantine IP or interface. Valid values: `none`, `attacker`.
* `quarantine_expiry` - Duration of quarantine in minute.
* `quarantine_log` - Enable/disable logging of selected quarantine. Valid values: `disable`, `enable`.
* `exempt_ip` - Exempted IP. The structure of `exempt_ip` block is documented below.

The `exempt_ip` block supports:

* `id` - Exempt IP ID.
* `src_ip` - Source IP address and netmask.
* `dst_ip` - Destination IP address and netmask.


## Attribute Reference

In addition to all the above arguments, the following attributes are exported:
* `id` - an identifier for the resource with format {{name}}.

## Import

Ips Sensor can be imported using any of these accepted formats:
```
$ terraform import fortios_ips_sensor.labelname {{name}}

If you do not want to import arguments of block:
$ export "FORTIOS_IMPORT_TABLE"="false"
$ terraform import fortios_ips_sensor.labelname {{name}}
$ unset "FORTIOS_IMPORT_TABLE"
```
